var NestedPages=NestedPages||{};NestedPages.SettingsReset=function(){var t=this,s=jQuery;return t.selectors={resetButton:"data-nestedpages-reset-settings",resetForm:".nestedpages-reset-settings",formComplete:".nestedpages-reset-settings-complete",resetAdminMenu:"data-nestedpages-reset-admin-menu"},t.bindEvents=function(){s(document).on("click","["+t.selectors.resetButton+"]",function(e){e.preventDefault(),t.resetSettings()}),s(document).on("click","["+t.selectors.resetAdminMenu+"]",function(e){e.preventDefault(),t.resetAdminMenu()})},t.resetSettings=function(){t.loading(!0),s.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.resetSettings,nonce:NestedPages.jsData.nonce},success:function(e){t.loading(!1),s(t.selectors.resetForm).hide(),s(t.selectors.formComplete).show(),"success"!==e.status&&console.log("There was an error saving toggled pages.")}})},t.resetAdminMenu=function(){t.loading(!0),s.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.resetAdminMenuSettings,nonce:NestedPages.jsData.nonce},success:function(e){t.loading(!1),"success"==e.status&&location.reload(),"success"!==e.status&&console.log("There was an error saving toggled pages.")}})},t.loading=function(e){if(e)return s("["+t.selectors.resetButton+"]").attr("disabled",!0),void s("["+t.selectors.resetAdminMenu+"]").attr("disabled",!0);s("["+t.selectors.resetButton+"]").removeAttr("disabled"),s("["+t.selectors.resetAdminMenu+"]").removeAttr("disabled")},t.bindEvents()},new NestedPages.SettingsReset,(NestedPages=NestedPages||{}).UserPreferencesReset=function(){var t=this,s=jQuery;return t.selectors={resetButton:"data-nestedpages-reset-user-prefs",resetForm:".nestedpages-reset-user-prefs",formComplete:".nestedpages-reset-user-prefs-complete"},t.bindEvents=function(){s(document).on("click","["+t.selectors.resetButton+"]",function(e){e.preventDefault(),t.resetPreferences()})},t.resetPreferences=function(){t.loading(!0),s.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.resetUserPrefs,nonce:NestedPages.jsData.nonce},success:function(e){t.loading(!1),s(t.selectors.resetForm).hide(),s(t.selectors.formComplete).show(),"success"!==e.status&&console.log("There was an error clearing user preferences.")}})},t.loading=function(e){e?s("["+t.selectors.resetButton+"]").attr("disabled",!0):s("["+t.selectors.resetButton+"]").removeAttr("disabled")},t.bindEvents()},new NestedPages.UserPreferencesReset,(NestedPages=NestedPages||{}).AdminCustomizationSettings=function(){var o=this,a=jQuery;return o.selectors={navItemCheckbox:"data-nestedpages-admin-nav-item-checkbox",adminNavList:"data-np-sortable-admin-nav",adminNavRoleSelect:"data-np-nav-menu-user-role-select",adminNavRoleMenu:"data-np-nav-menu-customization",adminNavDetails:"data-np-extra-options",adminNavDetailsToggle:"data-np-extra-options-button",adminSubNavList:"data-np-sortable-admin-subnav",submenuToggle:"data-np-nav-menu-customization-submenu-toggle",separatorRow:"data-np-separator-row",separatorRemoveButton:"data-np-remove-separator-button",separatorAddButton:"data-np-add-separator-button"},o.bindEvents=function(){a(document).ready(function(){o.enableSortableAdminSorting(),o.defaultAdminMenuRoleSelect()}),a(document).on("change","["+o.selectors.navItemCheckbox+"]",function(e){o.toggleNavItemVisibility(a(this))}),a(document).on("change","["+o.selectors.adminNavRoleSelect+"]",function(e){var t=a(this).val();o.toggleNavRoleMenu(t)}),a(document).on("click","["+o.selectors.adminNavDetailsToggle+"]",function(e){e.preventDefault(),o.toggleNavExtraOptions(a(this))}),a(document).on("click","["+o.selectors.submenuToggle+"]",function(e){e.preventDefault(),o.toggleSubmenu(a(this))}),a(document).on("click","["+o.selectors.separatorRemoveButton+"]",function(e){e.preventDefault(),o.removeSeparator(a(this))}),a(document).on("click","["+o.selectors.separatorAddButton+"]",function(e){e.preventDefault(),o.addSeparator()})},o.enableSortableAdminSorting=function(){a("["+o.selectors.adminNavList+"]").sortable({handle:".handle",items:".np-nav-preview",stop:function(e,t){var s=a("["+o.selectors.adminNavList+"] li");a.each(s,function(){a(this).find("[data-np-menu-order]").val(a(this).index())})}}),a("["+o.selectors.adminSubNavList+"]").sortable({handle:".handle",items:".submenu-item",stop:function(e,t){var s=a("["+o.selectors.adminSubNavList+"] li");a.each(s,function(){a(this).find("[data-np-submenu-order]").val(a(this).index())})}})},o.defaultAdminMenuRoleSelect=function(){a("["+o.selectors.adminNavRoleSelect+"]").find("option:eq(0)").prop("selected",!0)},o.toggleNavItemVisibility=function(e){var t=a(e).closest("li.np-nav-preview");!a(e).is(":checked")?a(t).removeClass("disabled"):a(t).addClass("disabled")},o.toggleNavRoleMenu=function(e){a("["+o.selectors.adminNavRoleMenu+"]").hide();var t=a("["+o.selectors.adminNavRoleMenu+'="'+e+'"]');a("["+o.selectors.adminNavRoleSelect+"]").val(e),a(t).show()},o.toggleNavExtraOptions=function(e){a(e).parents(".np-nav-preview").find("["+o.selectors.adminNavDetails+"]");a(e).parents(".np-nav-preview").toggleClass("options-open")},o.toggleSubmenu=function(e){a(e).toggleClass("active"),a(e).parents("li").toggleClass("submenu-open")},o.removeSeparator=function(e){a(e).closest("["+o.selectors.separatorRow+"]").fadeOut(function(){a(this).remove()})},o.addSeparator=function(){var e=a("["+o.selectors.adminNavList+"]:visible"),t=a(e).find("["+o.selectors.separatorRow+"]").length+1,s=a("["+o.selectors.adminNavRoleSelect+"]").val(),n='<li class="np-nav-preview separator" data-np-separator-row>';n+='<div class="menu-item">',n+='<div class="submenu-toggle"></div>',n+='<div class="handle"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class=" np-icon-menu"><path d="M0 0h24v24H0z" fill="none" /><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" class="bars" /></svg></div>',n+='<div class="title"><div class="menu-icon dashicons-before dashicons-admin-post"></div><p>Separator<button class="button button-small details-button" data-np-remove-separator-button="">Remove</button></p></div>\x3c!-- .title --\x3e',n+="</div>\x3c!-- .menu-item --\x3e",n+='<input type="hidden" name="nestedpages_admin[nav_menu_options]['+(s=s.replace("menu_role_",""))+"][custom_sep"+t+']" value="true">',n+='<input type="hidden" name="nestedpages_admin[nav_menu_options]['+s+"][custom_sep"+t+'][order]" value="" data-np-menu-order>',n+="</li>",a(e).prepend(n),o.resetNavOrder(a(e))},o.resetNavOrder=function(e){e=a(e).find("[data-np-menu-order]");a.each(e,function(e,t){a(this).val(e)}),o.enableSortableAdminSorting()},o.bindEvents()},new NestedPages.AdminCustomizationSettings,(NestedPages=NestedPages||{}).Settings=function(){var o=this,a=jQuery;return o.selectors={postTypeToggle:"[data-toggle-nestedpages-pt-settings]",postTypeCheckbox:"[data-nestedpages-settings-row-checkbox]",customFieldsCheckbox:"[data-toggle-nestedpages-cf-settings]",standardFieldsCheckbox:"[data-toggle-nestedpages-sf-settings]",taxonomiesFieldCheckbox:"[data-hide-taxonomies]",thumbnailsCheckbox:"[data-enable-thumbnails]",menuEnabledOption:"[data-menu-enabled-option]",disableMenuCheckbox:"[data-disable-menu-checkbox]",disableAutoCheckbox:"[data-menu-disable-auto-checkbox]",assignPostTypeCheckbox:"[data-nestedpages-assign-post-type]",assignPostTypeId:"[data-nested-pages-assign-post-type-id]",assignPostTypeTitle:"[data-nested-pages-assign-post-type-title]",assignPostTypeOption:"[data-assignment-page-id]",assignPostTypeRemove:"[data-nestedpages-page-pt-assignment-remove]",assignPostTypeSelection:"[data-nestedpages-page-pt-assignment-selection]",sortOptionCheckbox:"[data-nestedpages-sort-option-checkbox]",defaultSortOptions:"[data-nestedpages-sort-option-default]"},o.bindEvents=function(){a(document).ready(function(){o.toggleAllSettingsButtons(),o.toogleAllFieldSettings(".custom-fields"),o.toogleAllFieldSettings(".standard-fields"),o.toggleMenuCheckboxes(),o.toggleHideCheckbox(),o.toggleAssignPostType(),o.toggleAllDefaultSortOptions()}),a(document).on("click",o.selectors.postTypeToggle,function(e){e.preventDefault(),o.toggleRow(a(this))}),a(document).on("change",o.selectors.postTypeCheckbox,function(){o.toggleSettingsButton(a(this))}),a(document).on("change",o.selectors.customFieldsCheckbox,function(){o.toogleFieldSettings(a(this),".custom-fields")}),a(document).on("change",o.selectors.standardFieldsCheckbox,function(){o.toogleFieldSettings(a(this),".standard-fields")}),a(document).on("change",o.selectors.taxonomiesFieldCheckbox,function(){o.toggleTaxonomyCheckboxes(a(this))}),a(document).on("change",o.selectors.thumbnailsCheckbox,function(){o.toggleThumbnailSettings(a(this))}),a(document).on("change",o.selectors.disableMenuCheckbox,function(){o.toggleMenuCheckboxes()}),a(document).on("change",o.selectors.disableAutoCheckbox,function(){o.toggleHideCheckbox()}),a(document).on("change",o.selectors.assignPostTypeCheckbox,function(){o.toggleAssignPostType()}),a(document).on("click",o.selectors.assignPostTypeOption,function(e){e.preventDefault(),o.chooseAssignPostType(a(this))}),a(document).on("click",o.selectors.assignPostTypeRemove,function(e){e.preventDefault(),o.removeAssignPostType(a(this))}),a(document).on("change",o.selectors.sortOptionCheckbox,function(){o.toggleDefaultSortOptions(a(this))})},o.toggleRow=function(e){a(e).parent(".head").siblings(".body").toggle(),a(e).parents(".row-container").toggleClass("active")},o.toggleSettingsButton=function(e){var t=a(e).parents(".head").find(o.selectors.postTypeToggle);if(a(e).is(":checked"))return a(t).show(),void a(t).parents(".head").siblings(".body").find('input[type="hidden"]').attr("disabled",!1);a(t).hide(),a(t).parents(".head").siblings(".body").hide(),a(t).parents(".row-container").removeClass("active"),a(t).parents(".head").siblings(".body").find('input[type="checkbox"]').attr("checked",!1),a(t).parents(".head").siblings(".body").find('input[type="hidden"]').attr("disabled",!0),a(t).parents(".head").siblings(".body").find("select").val(!1)},o.toggleAllSettingsButtons=function(){var e=a(o.selectors.postTypeCheckbox);a.each(e,function(){o.toggleSettingsButton(a(this))})},o.toogleFieldSettings=function(e,t){t=a(e).parents(".body").find(t);a(e).is(":checked")?a(t).show():a(t).hide()},o.toogleAllFieldSettings=function(e){var t=a(o.selectors.customFieldsCheckbox);".standard-fields"==e&&(t=a(o.selectors.standardFieldsCheckbox)),a.each(t,function(){o.toogleFieldSettings(a(this),e)})},o.toggleTaxonomyCheckboxes=function(e){var t=a(e).parents("ul").find(a("*[data-taxonomy-single]"));a(e).is(":checked")?a(t).hide():a(t).show()},o.toggleThumbnailSettings=function(e){var t=a(e).parents(".field").find(a("*[data-thumbnail-options]"));a(e).is(":checked")?a(t).show():a(t).hide()},o.toggleMenuCheckboxes=function(){var e=a(o.selectors.disableMenuCheckbox),t=a(o.selectors.menuEnabledOption);a(e).is(":checked")?a(t).hide():a(t).show()},o.toggleHideCheckbox=function(){var e=a(o.selectors.disableAutoCheckbox),t=a("[data-menu-hide-checkbox]");a(e).is(":checked")?a(t).hide():a(t).show()},o.toggleAssignPostType=function(){var e=a(o.selectors.assignPostTypeCheckbox);a.each(e,function(){var e=a(this),t=a(this).parents(".field").find(".nestedpages-assignment-display");a(e).is(":checked")?a(t).show():a(t).hide()})},o.chooseAssignPostType=function(e){var t=a(e).attr("data-assignment-page-id"),s=a(e).attr("data-assignment-page-title"),n=a(e).parents(".field"),e=nestedpages.currently_assigned_to+" "+s+' <a href="#" data-nestedpages-page-pt-assignment-remove>('+nestedpages.remove+")</a>";a(n).find(o.selectors.assignPostTypeId).val(t),a(n).find(o.selectors.assignPostTypeTitle).val(s),a(n).find(o.selectors.assignPostTypeSelection).html(e).show(),a(n).find("[data-nestedpages-post-search-form]").hide()},o.removeAssignPostType=function(e){e=a(e).parents(".field");a(e).find(o.selectors.assignPostTypeSelection).hide(),a(e).find("[data-nestedpages-post-search-form]").show(),a(e).find(o.selectors.assignPostTypeId).val(""),a(e).find(o.selectors.assignPostTypeTitle).val("")},o.toggleAllDefaultSortOptions=function(){var e=a(o.selectors.sortOptionCheckbox);a.each(e,function(){o.toggleDefaultSortOptions(a(this))})},o.toggleDefaultSortOptions=function(e){var t=!!a(e).is(":checked"),e=a(e).parent("label").next(o.selectors.defaultSortOptions);a(e).length<1||(t?a(e).show():a(e).hide())},o.bindEvents()},new NestedPages.Settings;